<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>multidim.covertree.CoverTree &mdash; GDA Toolbox v1.0 Manual</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="GDA Toolbox v1.0 Manual" href="../index.html" >
    <link rel="up" title="Multidimensional Data" href="../multidimensional_data.html" >
    <link rel="next" title="multidim.covertree.CoverTree.make_edges" href="multidim.covertree.CoverTree.make_edges.html" >
    <link rel="prev" title="multidim.PointCloud.witnessed_barycenters" href="multidim.PointCloud.witnessed_barycenters.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">GDA Toolbox v1.0 Manual</a></li>
	
          <li class="active"><a href="../multidimensional_data.html" accesskey="U">Multidimensional Data</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="multidim.covertree.CoverTree.make_edges.html" title="multidim.covertree.CoverTree.make_edges"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="multidim.PointCloud.witnessed_barycenters.html" title="multidim.PointCloud.witnessed_barycenters"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="multidim-covertree-covertree">
<h1>multidim.covertree.CoverTree<a class="headerlink" href="#multidim-covertree-covertree" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="multidim.covertree.CoverTree">
<em class="property">class </em><code class="descclassname">multidim.covertree.</code><code class="descname">CoverTree</code><span class="sig-paren">(</span><em>pointcloud</em>, <em>ratio=0.41421356237309503</em>, <em>exchange_teens=True</em>, <em>sort_orphans_by_mean=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/multidim/covertree.html#CoverTree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#multidim.covertree.CoverTree" title="Permalink to this definition">¶</a></dt>
<dd><p>An efficient and convenient implementation of
the “Cover Tree with Friends” algorithm.  
This implementation follows the notation and terminology of the paper
<a class="reference internal" href="#r5eaa32f4d028-cder1" id="id1">[CDER1]</a> as carefully as possible; they were written in concert.</p>
<p>A CoverTree is an Python iterator object <a class="reference internal" href="#r5eaa32f4d028-iter1" id="id2">[iter1]</a> <a class="reference internal" href="#r5eaa32f4d028-iter2" id="id3">[iter2]</a>.
The <code class="xref py py-func docutils literal notranslate"><span class="pre">__next__()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">__getitem__()</span></code> methods yield the
<a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoverLevel</span></code></a> with that index.  The entire “friends” algorithm happens
in <code class="xref py py-func docutils literal notranslate"><span class="pre">multidim.covertree.CoverTree.__next__()</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pointcloud</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="multidim.PointCloud.html#multidim.PointCloud" title="multidim.PointCloud"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidim.PointCloud</span></code></a></span></dt>
<dd><p class="first last">The original data from which to construct a cover tree.  Note that the
labeling/weighting/indexing system requires the use of
<a class="reference internal" href="multidim.PointCloud.html#multidim.PointCloud" title="multidim.PointCloud"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidim.PointCloud</span></code></a> input, not merely a
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.  However, <a class="reference internal" href="#multidim.covertree.CoverTree" title="multidim.covertree.CoverTree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree</span></code></a> ignores all of the higher 
strata (edges, faces, and so on) of the <a class="reference internal" href="multidim.PointCloud.html#multidim.PointCloud" title="multidim.PointCloud"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidim.PointCloud</span></code></a>.
Only the points in stratum[0] are used.</p>
</dd>
<dt><strong>ratio</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Ratio <span class="math notranslate nohighlight">\(\theta\)</span> to shrink radii by at each step. Must satisfy
<span class="math notranslate nohighlight">\(0&lt;\theta&lt;1\)</span>. Good values are <code class="code docutils literal notranslate"><span class="pre">0.5</span></code> or
<code class="code docutils literal notranslate"><span class="pre">ratio_Ag</span></code> or <code class="code docutils literal notranslate"><span class="pre">ratio_Au</span></code>.  Default: <code class="code docutils literal notranslate"><span class="pre">ratio_Ag</span></code></p>
</dd>
<dt><strong>exchange_teens</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Should teens be exchanged at each step, using Type-2 friends?  
Default: <code class="code docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt><strong>sort_orphans_by_mean</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Should orphans be re-ordered by their proximity to weighted mean of the
labels?  This is particularly useful for improving the cross-validation
score of the <a class="reference internal" href="multidim.models.CDER.html#multidim.models.CDER" title="multidim.models.CDER"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidim.models.CDER</span></code></a> classifier.  Disable for
speed ordering of adults is irrelevant for your needs.
Default: <code class="code docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>:class:`multidim.covertree.CoverLevel`</strong></dt>
<dd><p class="first last">From level 0 (one ball) until all points are separated.  Each <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a> 
is cached once computed.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This section is excerpted and condensed from <a class="reference internal" href="#r5eaa32f4d028-cder1" id="id4">[CDER1]</a></p>
<p><strong>Definition</strong></p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be a finite subset of <span class="math notranslate nohighlight">\(\mathbb{R}^d\)</span>. 
The purpose of a cover tree is to build a filtration 
<span class="math notranslate nohighlight">\(\emptyset \subset CL_0 \subset CL_1 \subset \cdots \subset CL_{\text{max}} = X\)</span>
by covering it with balls of smaller and smaller radius centered at points in
the set. 
The points in <span class="math notranslate nohighlight">\(CL_\ell\)</span> are called the <strong>adults</strong> at level <span class="math notranslate nohighlight">\(\ell\)</span>.</p>
<p>Specifically, a <strong>cover tree</strong> is a filtration of <span class="math notranslate nohighlight">\(X\)</span> with the 
following additional properties:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(CL_0\)</span> contains a single point, <span class="math notranslate nohighlight">\(a_0\)</span>.  (see <code class="code docutils literal notranslate"><span class="pre">_adult0</span></code>)</li>
<li>There is a radius <span class="math notranslate nohighlight">\(r_0\)</span> (see <code class="code docutils literal notranslate"><span class="pre">_r0</span></code>) such that <span class="math notranslate nohighlight">\(X\)</span> is contained in the
ball <span class="math notranslate nohighlight">\(B(a_0, r_0)\)</span> of radius <span class="math notranslate nohighlight">\(r_0\)</span> around <span class="math notranslate nohighlight">\(a_0\)</span></li>
<li>There is a real number <span class="math notranslate nohighlight">\(0&lt; \theta &lt; 1\)</span> (see <code class="code docutils literal notranslate"><span class="pre">ratio</span></code>) such that, for every
<span class="math notranslate nohighlight">\(\ell\)</span>, the set <span class="math notranslate nohighlight">\(X\)</span> is a subset of
<span class="math notranslate nohighlight">\(\cup_{a_i \in CL_\ell} B(a_i, r_\ell)\)</span>
where <span class="math notranslate nohighlight">\(r_\ell = r_0 \theta^\ell\)</span></li>
<li>For each <span class="math notranslate nohighlight">\(\ell\)</span>, if <span class="math notranslate nohighlight">\(a_i, a_j \in CL_\ell\)</span>, then 
<em class="xref py py-obj">| a_i - a_j| &gt; r_ell</em>.  No two adults lie in the same ball.</li>
<li>For each <span class="math notranslate nohighlight">\(\ell\)</span>, each point <span class="math notranslate nohighlight">\(x \in X\)</span> is assigned to a
<strong>guardian</strong> <span class="math notranslate nohighlight">\(a_i \in CL_\ell\)</span> such that <span class="math notranslate nohighlight">\(x\)</span> lies in the ball
<span class="math notranslate nohighlight">\(B(a_i, r_\ell)\)</span>.  We say <span class="math notranslate nohighlight">\(x\)</span> is a <strong>child</strong> of <span class="math notranslate nohighlight">\(a_i\)</span>
at level <span class="math notranslate nohighlight">\(\ell\)</span>.  Each <span class="math notranslate nohighlight">\(a_i \in CL_\ell\)</span> is its own guardian
and its own child.</li>
<li>There is a tree structure on the (level, adult) pairs of the filtration
<span class="math notranslate nohighlight">\((\ell, a_i)\)</span>, where the tree relation
<span class="math notranslate nohighlight">\((\ell, a_i) \to (\ell+1, a_k)\)</span> holds if <span class="math notranslate nohighlight">\(a_k\)</span> was a child of
<span class="math notranslate nohighlight">\(a_i\)</span> at level <span class="math notranslate nohighlight">\(\ell\)</span>.  We say <span class="math notranslate nohighlight">\(a_k\)</span> is a
<strong>successor</strong> of <span class="math notranslate nohighlight">\(a_i\)</span>, and <span class="math notranslate nohighlight">\(a_i\)</span> is a <strong>predecessor</strong> of 
<span class="math notranslate nohighlight">\(a_k\)</span>.  Note that <span class="math notranslate nohighlight">\((\ell, a_i) \to (\ell+1, a_i)\)</span> for all
<span class="math notranslate nohighlight">\(a_i \in CL_\ell\)</span></li>
</ul>
<p>Extending the maturation/reproduction metaphor of <strong>adults</strong>, <strong>children</strong>, and
<strong>guardians</strong> above, a child <span class="math notranslate nohighlight">\(x\)</span> with guardian <span class="math notranslate nohighlight">\(a_i\)</span> at level
<span class="math notranslate nohighlight">\(\ell\)</span> is called a <strong>teen</strong> if <span class="math notranslate nohighlight">\(\frac12 r_\ell &lt; \|a_i - x\|\)</span>, and
it is called a <strong>youngin</strong> if <span class="math notranslate nohighlight">\(\|a_i - x\| \leq \frac12 r_\ell\)</span>.
The point of this is that we may require the additional condition:</p>
<ul class="simple">
<li>(Optional) On the previous condition, we can additionally require that
each <span class="math notranslate nohighlight">\(x\)</span> is the child of the <em>nearest</em> adult, if it lies in the
intersection of two or more balls of <span class="math notranslate nohighlight">\(B(a_i, r_\ell)\)</span>.  If two
adults are equally distant, choose the one of the lowest index.  This
option is enforced by the <code class="code docutils literal notranslate"><span class="pre">exchange_teens</span></code> flag.</li>
</ul>
<p>When changing from level math:<em class="xref py py-obj">ell</em> to level <span class="math notranslate nohighlight">\(\ell+1\)</span>, the radius of
each ball shrinks to <span class="math notranslate nohighlight">\(r_{\ell+1} = \theta r_\ell\)</span>.  Children farther than
<span class="math notranslate nohighlight">\(r_{\ell+1}\)</span> from their guardians become <strong>orphans</strong>.  We must decide
whether these orphans should be  <strong>adopted</strong> by other adults at level
<span class="math notranslate nohighlight">\(\ell+1\)</span>, or if the orphans should be <strong>emancipated</strong> as new adults at level
<span class="math notranslate nohighlight">\(\ell+1\)</span>.  That is, the newly emancipated adults at level
<span class="math notranslate nohighlight">\(\ell+1\)</span> comprise the <strong>cohort</strong> (see <code class="code docutils literal notranslate"><span class="pre">cohort</span></code>) at level $ell+1$.</p>
<p>We say <span class="math notranslate nohighlight">\(a_j \in CL_{\ell}\)</span> is an <strong>elder</strong> of 
<span class="math notranslate nohighlight">\(a_k \in CL_{\ell+1}\)</span> if the distance <span class="math notranslate nohighlight">\(\|a_j - a_k\|\)</span> is
sufficiently small that <span class="math notranslate nohighlight">\(a_j\)</span> <em>could have been</em> emancipated from
<span class="math notranslate nohighlight">\(a_k\)</span> between levels <span class="math notranslate nohighlight">\(\ell\)</span> and <span class="math notranslate nohighlight">\(\ell+1\)</span>.  That is,
if the tree structure were unknown, then elders of <span class="math notranslate nohighlight">\(a_j$ are the
possible predecessors.  If :math:\)</span> is its own predecessor (because it
was already an adult in <span class="math notranslate nohighlight">\(CL_{\ell}\)</span>, then the only elder of
<span class="math notranslate nohighlight">\(a_k\)</span> is itself.</p>
<p><strong>Example</strong></p>
<p>Consider this point cloud in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span></p>
<div class="math notranslate nohighlight">
\[X = \{(0,0.1),(1,2),(0,1),(0,0),(2,2),(2,2.2),(3,3),(1,1)\}\]</div>
<p>We index these points from 0 to 7 in the given order.
We have the following filtration</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;CL_0 = \{7\}\\
&amp;CL_1 = \{3, 4, 6, 7\}\\
&amp;CL_2 = \{1, 2, 3, 4, 6, 7\}\\
&amp;CL_3 = \{1, 2, 3, 4, 6, 7\}\\
&amp;CL_4 = \{1, 2, 3, 4, 5, 6, 7\}\\
&amp;CL_5 = \{0, 1, 2, 3, 4, 5, 6, 7\}\\\end{split}\]</div>
<p>We have the following cover ball radii</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;r_0 = 2\sqrt{2}\\
&amp;r_1 = \sqrt{2}\\
&amp;r_2 = \frac{\sqrt{2}}{2}\\
&amp;r_3 = \frac{\sqrt{2}}{4}\\
&amp;r_4= \frac{\sqrt{2}}{8}\\
&amp;r_5 = \frac{\sqrt{2}}{16}\end{split}\]</div>
<p>Here we have <span class="math notranslate nohighlight">\(a_0 = (1,1)\)</span>, <span class="math notranslate nohighlight">\(r_0 = 2\sqrt{2}\)</span>, and
<span class="math notranslate nohighlight">\(\theta = 1/2\)</span>.</p>
<p><strong>The Friends Algorithm</strong></p>
<p>Our algorithm is based upon the concept of <strong>friends</strong>. To each adult there
will be associated <em>three</em> types of friends.  Types 1, 2,
and 3 are used to build the <a class="reference internal" href="#multidim.covertree.CoverTree" title="multidim.covertree.CoverTree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree</span></code></a> in typically linear time.</p>
<p>Let <span class="math notranslate nohighlight">\(a_i \in CL_\ell\)</span>, that is, <span class="math notranslate nohighlight">\(a_i\)</span> is an adult at level
<span class="math notranslate nohighlight">\(\ell\)</span>. Define the following thresholds</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_1(\ell) &amp;= (2 + \theta)r_l \\
T_2(\ell) &amp;= (2 + 2\theta)r_l \\
T_3(\ell) &amp;= \frac{2}{1 - \theta}r_l.\end{split}\]</div>
<p>It is elementary to show that <span class="math notranslate nohighlight">\(T_1(l) &lt; T_2(l) &lt; T_3(l)\)</span>.
Moreover, we have the recursion relation
<span class="math notranslate nohighlight">\(T_3(l) &lt; T_3(l-1)\)</span>.</p>
<p>Each level of the filtreation and all of this associated data is stored in 
a <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a> object.</p>
<p>The algorithm works like this, using a “reproduction” metaphor:</p>
<blockquote>
<div><ul>
<li><p class="first">Level 0 (see <code class="code docutils literal notranslate"><span class="pre">covertree[0]</span></code> of type <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a>) has a single adult.  All
points are its children.  Its only friends are itself.</p>
</li>
<li><p class="first">…</p>
</li>
<li><p class="first">Level <span class="math notranslate nohighlight">\(\ell\)</span> (see <code class="code docutils literal notranslate"><span class="pre">covertree[l]</span></code> of type <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a>)
has known adults, friends1, friends3, friends3, and children.  We now
compute level <span class="math notranslate nohighlight">\(\ell+1.\)</span> in <code class="xref py py-func docutils literal notranslate"><span class="pre">__next__()</span></code></p>
<p>1. Shrink the radius by a factor of <span class="math notranslate nohighlight">\(\theta\)</span>. Some children
become orphans.</p>
<p>2. Orphans are adopted or become newly emanicpated adults.  This uses
<span class="math notranslate nohighlight">\(T_1(\ell)\)</span>.</p>
<p>3. If <code class="code docutils literal notranslate"><span class="pre">exhange_teens</span> <span class="pre">is</span> <span class="pre">True</span></code>, then children who are teens are
re-assigned to the closest possible adult.  This uses
<span class="math notranslate nohighlight">\(T_2(\ell)\)</span>.</p>
<ol class="arabic simple" start="4">
<li>Compute new friends3.</li>
<li>Use new friends3 to compute new friends1, friends2, friends3.</li>
</ol>
</li>
<li><p class="first">Level <span class="math notranslate nohighlight">\(\ell+1\)</span> (see <code class="code docutils literal notranslate"><span class="pre">covertree[l+1]</span></code> of type <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a>)
has known adults, friends1, friends3, friends3, and
children.  We now compute level <span class="math notranslate nohighlight">\(l+2\)</span></p>
</li>
<li><p class="first">…</p>
</li>
<li><p class="first">Stop when all points are adults.</p>
</li>
</ul>
</div></blockquote>
<p>Levels are evaluated lazily and cached.  For example,
if no levels have been computed, then
<code class="code docutils literal notranslate"><span class="pre">covertree[3]</span></code> will compute levels 0, 1, 2, and 3.
Then <code class="code docutils literal notranslate"><span class="pre">covertree[5]</span></code> will use those values for 0, 1, 2, 3 to compute 4
and 5.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r5eaa32f4d028-cder1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[CDER1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> Supervised Learning of Labeled Pointcloud Differences via Cover-Tree Entropy Reduction <a class="reference external" href="https://arxiv.org/abs/1702.07959">https://arxiv.org/abs/1702.07959</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5eaa32f4d028-cder2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[CDER2]</a></td><td>CDER, Learning with Friends <a class="reference external" href="https://www.ima.umn.edu/2016-2017/DSS9.6.16-5.30.17/26150">https://www.ima.umn.edu/2016-2017/DSS9.6.16-5.30.17/26150</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5eaa32f4d028-iter1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[iter1]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html?highlight=iterator#iterator-types">https://docs.python.org/3/library/stdtypes.html?highlight=iterator#iterator-types</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r5eaa32f4d028-iter2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[iter2]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> <a class="reference external" href="https://wiki.python.org/moin/Iterator">https://wiki.python.org/moin/Iterator</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pc</span> <span class="o">=</span> <span class="n">PointCloud</span><span class="o">.</span><span class="n">from_multisample_multilabel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mf">2.2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])],</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">CoverTree</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sort_orphans_by_mean</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span><span class="o">=</span><span class="n">ct</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">adults</span><span class="p">)</span>
<span class="go">[7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pc</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">7</span><span class="p">,:]</span>
<span class="go">array([ 1.,  1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cl</span>
<span class="go">Level 0 using 1 adults at radius 2.8284271247...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="go">Level 1 using 2 adults at radius 1.4142135623...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">ct</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">exponent</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">adults</span><span class="p">))</span>
<span class="go">0 [7]</span>
<span class="go">1 [7, 5]</span>
<span class="go">2 [7, 5, 0, 1, 2, 6]</span>
<span class="go">3 [7, 5, 0, 1, 2, 6]</span>
<span class="go">4 [7, 5, 0, 1, 2, 6, 4]</span>
<span class="go">5 [7, 5, 0, 1, 2, 6, 4, 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span><span class="o">.</span><span class="n">cohort</span>
<span class="go">array([2, 2, 2, 5, 4, 1, 2, 0])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pointcloud</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference internal" href="multidim.PointCloud.html#multidim.PointCloud" title="multidim.PointCloud"><code class="xref py py-class docutils literal notranslate"><span class="pre">multidim.PointCloud</span></code></a></span></dt>
<dd><p class="first last">The original dataset.</p>
</dd>
<dt><strong>ratio</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></span></dt>
<dd><p class="first last">Ratio <span class="math notranslate nohighlight">\(\theta\)</span> by which to shrink the ball radius between levels.</p>
</dd>
<dt><strong>_r0</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float64</span></code></span></dt>
<dd><p class="first last">The initial radius at level 0.</p>
</dd>
<dt><strong>_adult0</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.int64</span></code></span></dt>
<dd><p class="first last">The index of the original adult.  Typically, this is the index of the
point nearest the weighted mean of the <code class="xref py py-class docutils literal notranslate"><span class="pre">PointCloud</span></code></p>
</dd>
<dt><strong>_levels</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.python.org/dev/library/collections.html#collections.OrderedDict" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.OrderedDict</span></code></a></span></dt>
<dd><p class="first last">An ordered dictionary to cache the levels computed so far, keyed by the
index.  Typically, a user would never access this directly.  Insead, use
<code class="code docutils literal notranslate"><span class="pre">covertree[i]</span></code></p>
</dd>
<dt><strong>cohort</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></span></dt>
<dd><p class="first last">An array of <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.int64</span></code>, which keeps track of the cohort 
(that is, the level in the filtration) of each point.  If a point has
not been born as an adult yet, the value is -1</p>
</dd>
<dt><strong>level_pointer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Index of the currently referenced <a class="reference internal" href="multidim.covertree.CoverLevel.html#multidim.covertree.CoverLevel" title="multidim.covertree.CoverLevel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverLevel</span></code></a>, for iteration purposes.
Setting this is like using <code class="xref py py-func docutils literal notranslate"><span class="pre">file.seek()</span></code> on file objects.  Usually,
you don’t want to mess with it, but it is used internally in
<code class="xref py py-class docutils literal notranslate"><span class="pre">mutlidim.models.CDER</span></code> for comparing entropy between levels.</p>
</dd>
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of points in <code class="code docutils literal notranslate"><span class="pre">self.pointcloud</span></code></p>
</dd>
<dt><strong>allpoints</strong> <span class="classifier-delimiter">:</span> <span class="classifier"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></span></dt>
<dd><p class="first last">The raw NumPY array underlying <code class="code docutils literal notranslate"><span class="pre">self.pointcloud</span></code>.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="multidim.covertree.CoverTree.make_edges.html#multidim.covertree.CoverTree.make_edges" title="multidim.covertree.CoverTree.make_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.make_edges</span></code></a>([min_distance,&nbsp;…])</td>
<td>Iterate over the edges between the points of the underlying <code class="xref py py-obj docutils literal notranslate"><span class="pre">PointCloud</span></code>, where min_distance &lt; length &lt;= max_distance.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="multidim.covertree.CoverTree.next.html#multidim.covertree.CoverTree.next" title="multidim.covertree.CoverTree.next"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.next</span></code></a>()</td>
<td>See <code class="xref py py-func docutils literal notranslate"><span class="pre">__next__()</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="multidim.covertree.CoverTree.plot.html#multidim.covertree.CoverTree.plot" title="multidim.covertree.CoverTree.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.plot</span></code></a>(canvas,&nbsp;**kwargs)</td>
<td>Interactive plot of a CoverTree, with dynamic computation of levels.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="multidim.covertree.CoverTree.plot_tree.html#multidim.covertree.CoverTree.plot_tree" title="multidim.covertree.CoverTree.plot_tree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.plot_tree</span></code></a>(canvas[,&nbsp;show_balls,&nbsp;…])</td>
<td>Plot the tree of a CoverTree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="multidim.covertree.CoverTree.reset.html#multidim.covertree.CoverTree.reset" title="multidim.covertree.CoverTree.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.reset</span></code></a>()</td>
<td>Go to level -1.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="multidim.covertree.CoverTree.sparse_complex.html#multidim.covertree.CoverTree.sparse_complex" title="multidim.covertree.CoverTree.sparse_complex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoverTree.sparse_complex</span></code></a>([level])</td>
<td>Make a sparse complex from this CoverTree, using the type-4 friends  algorithm.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="multidim.PointCloud.witnessed_barycenters.html"
                        title="previous chapter">multidim.PointCloud.witnessed_barycenters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="multidim.covertree.CoverTree.make_edges.html"
                        title="next chapter">multidim.covertree.CoverTree.make_edges</a></p>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2015-2017, Geometric Data Analytics, Inc.
      </li>
      <li>
      Last updated on Jan 07, 2019.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.2.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>